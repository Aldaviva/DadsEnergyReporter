DadsEnergyReporter
===

Send monthly electricity usage reports from SolarCity, aligned to Orange & Rockland billing cycles.

## Problem

My parents' house gets its electricity from both [Orange & Rockland](https://www.oru.com), a public utility company, and two arrays of roof-mounted solar panels leased from [SolarCity](http://www.solarcity.com/).

My dad wants to know how many kilowatt-hours of electricity were generated by the solar panels compared to how many were bought from the utility each month, so that he can tell how much of an impact the solar panels are making on his electricity cost.

### Challenges

- SolarCity provides a web application, [MySolarCity](https://mysolarcity.com/), that shows how much electricity was generated using a reporting tool called [PowerGuide](https://mysolarcity.com/#/monitoring). You can view graphs for a given day, month, or year. Unfortunately, PowerGuide reports are always aligned to the start of the report period, for example, month reports always start on the 1st of the month.
- Orange & Rockland billing cycles never begin on the 1st of the month. In fact, the billing date is completely unpredictable. The most common billing date is the 17th, but only 42% of the past two years of bills actually ended on the 17th, and they have varied between the 15th and 21st with no discernible pattern.

## Solution

I wrote a program that can be run periodically to send an email report of electricity statistics for both Orange & Rockland and SolarCity.

### Algorithm

1. Log in to Orange & Rockland
1. Log in to MySolarCity
1. Download [ESPI Green Button Data](https://naesb.org/espi_standards.asp) from Orange & Rockland
1. Extract the start and end date, kWh consumed, and billing amount from the Green Button data for the most recent billing interval
1. Download PowerGuide measurements from MySolarCity
1. Extract the kWh generated from the PowerGuide data for the most recent billing interval 
1. Send an email report containing this information
1. Log out of Orange & Rockland and MySolarCity
1. Persist the billing date to avoid resending the report for the same billing interval the next time this program runs
1. Exit

## Project Information

- Runs in .NET Framework 4.7
- Builds in Visual Studio 2017
